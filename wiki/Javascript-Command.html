<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en" xmlns="http://www.w3.org/1999/html"><!--<![endif]-->
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width" />
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  <title>Javascript Command |  OrientDB</title>
  <title>Javascript Command</title>
  <link href="../stylesheets/foundation.min.css" media="screen" rel="stylesheet" type="text/css" />
<link href="../stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
  <script src="../javascripts/modernizr.foundation.js" type="text/javascript"></script>
  
</head>
<body class="orientdb orientdb_wiki orientdb_wiki_Javascript-Command">

<header>
  <div class="row">
    <div class="five columns">
      <h1>
        <a href="/">
          Orient<span class="highl">DB</span>
        </a>
        <span class="subtitle">The Document/Graph NoSQL Database</span>
      </h1>
    </div>
    <div class="seven columns right">
      <ul class="inline-list">
        <li><a href="/orientdb/"> Home</a></li>
<li><a href="/orientdb/about.html"> About</a></li>
<li class="active"><a href="/orientdb/wiki/Home.html"> Documentation</a></li>
<li><a href="/orientdb/wiki/Download.html"> Downloads</a></li>
<li><a href="/orientdb/community.html"> Community</a></li>
      </ul>
    </div>
  </div>
</header>


<div class="page-header">
  <div class="row">
    <div class="twelve columns">
      <h2>
        <i class="icon-orientdb"></i>
        Javascript Command
        
          <ul class="bcs">
          
            <li><a href="/orientdb/wiki/DB-Server.html" class="nr1">Db Server</a></li>
          
            <li><a href="/orientdb/wiki/Home.html" class="nr2">Home</a></li>
          
          </ul>
        
        
      </h2>
    </div>
  </div>
</div>

<div id="main" class="row wiki">

  <div class="twelve columns content" role="content">

    <h3>Introduction</h3>

<p>Starting from version 1.0, OrientDB supports server side scripting. All the <a href="http://en.wikipedia.org/wiki/List_of_JVM_languages">JVM languages</a> are supported. By default <a href="http://en.wikipedia.org/wiki/JavaScript">Javascript</a> is installed.</p>

<p>Scripts can be executed client and server side. For the client side the user must have the privilege of READ against "database.command" resource. For the server side the server must <a href="#Enable_Server_side_scripting">enable the scripting interpreter</a> that are disabled by default for security reason.</p>

<h3>Usage</h3>

<h3>Via Java API</h3>

<p>Execute a command like SQL but using the class OCommandScript passing the language to use. Javascript is installed by default. Example:
</p><div class="highlight"><pre>  <span class="n">db</span><span class="o">.</span><span class="na">command</span><span class="o">(</span> <span class="k">new</span> <span class="n">OCommandScript</span><span class="o">(</span><span class="s">"Javascript"</span><span class="o">,</span> <span class="s">"print('hello world')"</span><span class="o">)</span> <span class="o">).</span><span class="na">execute</span><span class="o">();</span>
</pre></div>

<h4>Via console</h4>

<p>Javascript code can be executed at client-side, the console, or server-side:</p>

<ul>
<li>Use <strong>js</strong> to execute the script at the <strong>client-side</strong> running it in the console</li>
<li>use <strong>jss</strong> to execute the script at the <strong>server-side</strong>. This feature is disabled by default. To enable it look at <a href="#Enable_Server_side_scripting">Enable Server side scripting</a>.</li>
</ul><p>Since the semicolon (;) character is used in both console and Javascript language to separate statements, how to execute multiple commands in the console and Javascript?</p>

<p>OrientDB console uses a reserved keywork "end" to switch from the Javascript mode to the console mode.</p>

<p>Example:
</p><div class="highlight"><pre>  orientdb&gt; connect remote:localhost/demo admin admin; js for( i = 0; i <span class="nt">&lt; 10</span><span class="err">;</span> <span class="err">i++</span> <span class="err">){</span> <span class="err">db.query('select</span> <span class="err">from</span> <span class="err">MapPoint')</span> <span class="err">};end;</span> <span class="err">exit</span>
</pre></div>

<p>This line connects to the remote server and execute on the console 10 queries. The 'end' switch the mode back to the OrientDB console and then executes the console 'exit' command.</p>

<p>Below an example to display the result of a query server and client side.
1. connects to the remote server as 'admin'
1. Execute a query and assign the result to the variable 'r', then display it server side and return it to being displayed client side too
1. Exit the console</p>

<h5>Interactive mode</h5>

<div class="highlight"><pre><span class="n">$</span> <span class="o">./</span><span class="n">console</span><span class="o">.</span><span class="na">sh</span>
<span class="n">OrientDB</span> <span class="n">console</span> <span class="n">v</span><span class="o">.</span><span class="mf">1.0</span><span class="o">-</span><span class="n">SNAPSHOT</span> <span class="o">(</span><span class="n">build</span> <span class="mi">11761</span><span class="o">)</span> <span class="n">www</span><span class="o">.</span><span class="na">orientechnologies</span><span class="o">.</span><span class="na">com</span>
<span class="n">Type</span> <span class="err">'</span><span class="n">help</span><span class="err">'</span> <span class="n">to</span> <span class="n">display</span> <span class="n">all</span> <span class="n">the</span> <span class="n">commands</span> <span class="n">supported</span><span class="o">.</span>

<span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">connect</span> <span class="nl">remote:</span><span class="n">localhost</span><span class="o">/</span><span class="n">demo</span> <span class="n">admin</span> <span class="n">admin</span>
<span class="n">Connecting</span> <span class="n">to</span> <span class="n">database</span> <span class="o">[</span><span class="nl">remote:</span><span class="n">localhost</span><span class="o">/</span><span class="n">demo</span><span class="o">]</span> <span class="n">with</span> <span class="n">user</span> <span class="err">'</span><span class="n">admin</span><span class="err">'</span><span class="o">...</span><span class="na">OK</span>

<span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">jss</span> <span class="n">var</span> <span class="n">r</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="err">'</span><span class="n">select</span> <span class="n">from</span> <span class="n">ouser</span><span class="err">'</span><span class="o">);</span><span class="n">print</span><span class="o">(</span><span class="n">r</span><span class="o">);</span><span class="n">r</span>

<span class="o">---+---------+--------------------+--------------------+--------------------+--------------------</span>
  <span class="err">#</span><span class="o">|</span> <span class="n">RID</span>     <span class="o">|</span><span class="n">name</span>                <span class="o">|</span><span class="n">password</span>            <span class="o">|</span><span class="n">status</span>              <span class="o">|</span><span class="n">roles</span>
<span class="o">---+---------+--------------------+--------------------+--------------------+--------------------</span>
  <span class="mi">0</span><span class="o">|</span>     <span class="err">#</span><span class="mi">4</span><span class="o">:</span><span class="mi">0</span><span class="o">|</span><span class="n">admin</span>               <span class="o">|{</span><span class="n">SHA</span><span class="o">-</span><span class="mi">256</span><span class="o">}</span><span class="mi">8</span><span class="n">C6976E5B5410415BDE908BD4DEE15DFB167A9C873FC4BB8A81F6F2AB448A918</span><span class="o">|</span><span class="n">ACTIVE</span>              <span class="o">|[</span><span class="mi">1</span><span class="o">]</span>
  <span class="mi">1</span><span class="o">|</span>     <span class="err">#</span><span class="mi">4</span><span class="o">:</span><span class="mi">1</span><span class="o">|</span><span class="n">reader</span>              <span class="o">|{</span><span class="n">SHA</span><span class="o">-</span><span class="mi">256</span><span class="o">}</span><span class="mi">3</span><span class="n">D0941964AA3EBDCB00CCEF58B1BB399F9F898465E9886D5AEC7F31090A0FB30</span><span class="o">|</span><span class="n">ACTIVE</span>              <span class="o">|[</span><span class="mi">1</span><span class="o">]</span>
  <span class="mi">2</span><span class="o">|</span>     <span class="err">#</span><span class="mi">4</span><span class="o">:</span><span class="mi">2</span><span class="o">|</span><span class="n">writer</span>              <span class="o">|{</span><span class="n">SHA</span><span class="o">-</span><span class="mi">256</span><span class="o">}</span><span class="n">B93006774CBDD4B299389A03AC3D88C3A76B460D538795BC12718011A909FBA5</span><span class="o">|</span><span class="n">ACTIVE</span>              <span class="o">|[</span><span class="mi">1</span><span class="o">]</span>
<span class="o">---+---------+--------------------+--------------------+--------------------+--------------------</span>
<span class="n">Script</span> <span class="n">executed</span> <span class="n">in</span> <span class="mi">0</span><span class="o">,</span><span class="mi">073000</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span> <span class="n">Returned</span> <span class="mi">3</span> <span class="n">records</span>

<span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">exit</span>
</pre></div>

<h5>Batch mode</h5>

<p>The same example above is execute in batch mode:
</p><div class="highlight"><pre><span class="n">$</span> <span class="o">./</span><span class="n">console</span><span class="o">.</span><span class="na">sh</span> <span class="s">"connect remote:localhost/demo admin admin;jss var r = db.query('select from ouser');print(r);r;exit"</span>
<span class="n">OrientDB</span> <span class="n">console</span> <span class="n">v</span><span class="o">.</span><span class="mf">1.0</span><span class="o">-</span><span class="n">SNAPSHOT</span> <span class="o">(</span><span class="n">build</span> <span class="mi">11761</span><span class="o">)</span> <span class="n">www</span><span class="o">.</span><span class="na">orientechnologies</span><span class="o">.</span><span class="na">com</span>
<span class="n">Type</span> <span class="err">'</span><span class="n">help</span><span class="err">'</span> <span class="n">to</span> <span class="n">display</span> <span class="n">all</span> <span class="n">the</span> <span class="n">commands</span> <span class="n">supported</span><span class="o">.</span>
<span class="n">Connecting</span> <span class="n">to</span> <span class="n">database</span> <span class="o">[</span><span class="nl">remote:</span><span class="n">localhost</span><span class="o">/</span><span class="n">demo</span><span class="o">]</span> <span class="n">with</span> <span class="n">user</span> <span class="err">'</span><span class="n">admin</span><span class="err">'</span><span class="o">...</span><span class="na">OK</span>

<span class="o">---+---------+--------------------+--------------------+--------------------+--------------------</span>
  <span class="err">#</span><span class="o">|</span> <span class="n">RID</span>     <span class="o">|</span><span class="n">name</span>                <span class="o">|</span><span class="n">password</span>            <span class="o">|</span><span class="n">status</span>              <span class="o">|</span><span class="n">roles</span>
<span class="o">---+---------+--------------------+--------------------+--------------------+--------------------</span>
  <span class="mi">0</span><span class="o">|</span>     <span class="err">#</span><span class="mi">4</span><span class="o">:</span><span class="mi">0</span><span class="o">|</span><span class="n">admin</span>               <span class="o">|{</span><span class="n">SHA</span><span class="o">-</span><span class="mi">256</span><span class="o">}</span><span class="mi">8</span><span class="n">C6976E5B5410415BDE908BD4DEE15DFB167A9C873FC4BB8A81F6F2AB448A918</span><span class="o">|</span><span class="n">ACTIVE</span>              <span class="o">|[</span><span class="mi">1</span><span class="o">]</span>
  <span class="mi">1</span><span class="o">|</span>     <span class="err">#</span><span class="mi">4</span><span class="o">:</span><span class="mi">1</span><span class="o">|</span><span class="n">reader</span>              <span class="o">|{</span><span class="n">SHA</span><span class="o">-</span><span class="mi">256</span><span class="o">}</span><span class="mi">3</span><span class="n">D0941964AA3EBDCB00CCEF58B1BB399F9F898465E9886D5AEC7F31090A0FB30</span><span class="o">|</span><span class="n">ACTIVE</span>              <span class="o">|[</span><span class="mi">1</span><span class="o">]</span>
  <span class="mi">2</span><span class="o">|</span>     <span class="err">#</span><span class="mi">4</span><span class="o">:</span><span class="mi">2</span><span class="o">|</span><span class="n">writer</span>              <span class="o">|{</span><span class="n">SHA</span><span class="o">-</span><span class="mi">256</span><span class="o">}</span><span class="n">B93006774CBDD4B299389A03AC3D88C3A76B460D538795BC12718011A909FBA5</span><span class="o">|</span><span class="n">ACTIVE</span>              <span class="o">|[</span><span class="mi">1</span><span class="o">]</span>
<span class="o">---+---------+--------------------+--------------------+--------------------+--------------------</span>
<span class="n">Script</span> <span class="n">executed</span> <span class="n">in</span> <span class="mi">0</span><span class="o">,</span><span class="mi">099000</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span> <span class="n">Returned</span> <span class="mi">3</span> <span class="n">records</span>
</pre></div>

<h3>Examples of usage</h3>

<h4>Insert 1000 records</h4>

<div class="highlight"><pre>  orientdb&gt; js for( i = 0; i <span class="nt">&lt; 1000</span><span class="err">;</span> <span class="err">i++</span> <span class="err">){</span> <span class="err">db.query(</span> <span class="err">'insert</span> <span class="err">into</span> <span class="err">jstest</span> <span class="err">(label)</span> <span class="err">values</span> <span class="err">("test'+i+'")'</span> <span class="err">);</span> <span class="err">}</span>
</pre></div>

<h4>Create documents using wrapped Java API</h4>

<div class="highlight"><pre>  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">js</span> <span class="k">new</span> <span class="n">com</span><span class="o">.</span><span class="na">orientechnologies</span><span class="o">.</span><span class="na">orient</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">record</span><span class="o">.</span><span class="na">impl</span><span class="o">.</span><span class="na">ODocument</span><span class="o">(</span><span class="err">'</span><span class="n">Profile</span><span class="err">'</span><span class="o">).</span><span class="na">field</span><span class="o">(</span><span class="err">'</span><span class="n">name</span><span class="err">'</span><span class="o">,</span> <span class="err">'</span><span class="n">Luca</span><span class="err">'</span><span class="o">).</span><span class="na">save</span><span class="o">()</span>
  
  <span class="n">Client</span> <span class="n">side</span> <span class="n">script</span> <span class="n">executed</span> <span class="n">in</span> <span class="mi">0</span><span class="o">,</span><span class="mi">426000</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span> <span class="n">Value</span> <span class="n">returned</span> <span class="nl">is:</span> <span class="n">Profile</span><span class="err">#</span><span class="mi">11</span><span class="o">:</span><span class="mi">52</span><span class="o">{</span><span class="nl">name:</span><span class="n">Luca</span><span class="o">}</span> <span class="n">v3</span>
</pre></div>

<h3>Enable Server side scripting</h3>

<p>For security reason server-side scripting is disabled by default on server. To enable it change the enable field to "true" in <strong>orientdb-server-config.xml</strong> file:
</p><div class="highlight"><pre>  <span class="c">&lt;!-- SERVER SIDE SCRIPT INTERPRETER. WARNING! THIS CAN BE A SECURITY HOLE: ENABLE IT ONLY IF CLIENTS ARE TRUSTED, TO TURN ON SET THE 'ENABLED' PARAMETER TO 'true' --&gt;</span>
  <span class="nt">&lt;handler</span> <span class="na">class=</span><span class="s">"com.orientechnologies.orient.server.handler.OServerSideScriptInterpreter"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;parameters&gt;</span>
      <span class="nt">&lt;parameter</span> <span class="na">name=</span><span class="s">"enabled"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/parameters&gt;</span>
  <span class="nt">&lt;/handler&gt;</span>
</pre></div>

<p><em>NOTE: this will allow to clients to execute any code inside the server. Enable it only if clients are trusted.</em></p>


  </div>

</div>

<footer>
  <div class="row">
    <div class="six columns">
      <ul class="inline-list">
        <li><a href="/orientdb/"> Home</a></li>
<li><a href="/orientdb/about.html"> About</a></li>
<li class="active"><a href="/orientdb/wiki/Home.html"> Documentation</a></li>
<li><a href="/orientdb/wiki/Download.html"> Downloads</a></li>
<li><a href="/orientdb/community.html"> Community</a></li>
      </ul>
    </div>
    <div class="six columns">
      <p class="copyright">
        Copyright &copy; 2011-2012 NuvolaBase Ltd. <br/>
        <span class="small">NuvolaBase is a registered trademark. All Rights Reserved.</span>
      </p>
    </div>
  </div>
</footer>

<script src="../javascripts/app.js" type="text/javascript"></script>

</body>
</html>