<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en" xmlns="http://www.w3.org/1999/html"><!--<![endif]-->
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width" />
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  <title>Distributed How To |  OrientDB</title>
  <title>Distributed How To</title>
  <link href="../stylesheets/foundation.min.css" media="screen" rel="stylesheet" type="text/css" />
<link href="../stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
  <script src="../javascripts/modernizr.foundation.js" type="text/javascript"></script>
  
</head>
<body class="wiki wiki_Distributed-How-To">

<header>
  <div class="row">
    <div class="five columns">
      <h1>
        <a href="/">
          Orient<span class="highl">DB</span>
        </a>
        <span class="subtitle">The Document/Graph NoSQL Database</span>
      </h1>
    </div>
    <div class="seven columns right">
      <ul class="inline-list">
        <li><a href="/"> Home</a></li>
<li><a href="/about.html"> About</a></li>
<li class="active"><a href="/wiki/Home.html"> Documentation</a></li>
<li><a href="/wiki/Download.html"> Downloads</a></li>
<li><a href="/community.html"> Community</a></li>
      </ul>
    </div>
  </div>
</header>


<div class="page-header">
  <div class="row">
    <div class="twelve columns">
      <h2>
        <i class="icon-wiki"></i>
        Distributed How To
        
          <ul class="bcs">
          
            <li><a href="/wiki/Distributed-Architecture.html" class="nr1">Distributed Architecture</a></li>
          
            <li><a href="/wiki/Home.html" class="nr2">Home</a></li>
          
          </ul>
        
        
      </h2>
    </div>
  </div>
</div>

<div id="main" class="row wiki">

  <div class="twelve columns content" role="content">

    <p>Before to start the replication between two server nodes assure that both server are in the same <a class="internal absent" href="/wiki/Clustering.html">Clustering</a>. To know the cluster configuration type in a OrientDB console:
</p><div class="highlight"><pre>  <span class="o">&gt;</span> <span class="n">cluster</span> <span class="n">status</span>
  
  <span class="n">Cluster</span> <span class="nl">status:</span>
  <span class="o">{</span><span class="s">"demo"</span><span class="o">:{</span>
      <span class="s">"nodes"</span><span class="o">:</span> <span class="o">[{</span>
        <span class="s">"id"</span><span class="o">:</span> <span class="s">"192.168.1.101:2434"</span><span class="o">,</span> 
        <span class="s">"mode"</span><span class="o">:</span> <span class="s">"synch"</span>
        <span class="o">},</span> <span class="o">{</span>
        <span class="s">"id"</span><span class="o">:</span> <span class="s">"192.168.1.101:2435"</span><span class="o">,</span> 
        <span class="s">"mode"</span><span class="o">:</span> <span class="s">"synch"</span>
        <span class="o">}]</span>
    <span class="o">}</span>
  <span class="o">}</span>
</pre></div>

<p>If the remote server doesn't have yet the database you must copy it before to start the replication. To copy a database you can:</p>

<ul>
<li>export and import it in the remote server</li>
<li>copy the database folder to the remote server (assure the server is not running)</li>
<li>make a hot-copy of the database</li>
</ul><h3>Main operations</h3>

<h4>Hot-copy a database</h4>

<p>To execute a hot-copy across the network use the <code>copy database</code> console command.
Syntax:
</p><div class="highlight"><pre>  &gt; copy database <span class="nt">&lt;database-name&gt;</span> <span class="nt">&lt;server-name&gt;</span>:<span class="nt">&lt;server-port&gt;</span> <span class="nt">&lt;database-type&gt;</span>
</pre></div>
Where:

<ul>
<li>
<code>&lt;database-name&gt;</code> is the database name</li>
<li>
<code>&lt;server-name&gt;&gt;</code> remote server name as host or ip address</li>
<li>
<code>&lt;server-port&gt;&gt;</code> remote server port number</li>
<li>
<code>&lt;database-type&gt;</code> is the database type between the supported ones: local, for persistent database, and memory for a volatile database</li>
</ul><p>Example to copy the demo database to another server using it as a persistent (local) database:
</p><div class="highlight"><pre>  <span class="o">&gt;</span> <span class="n">copy</span> <span class="n">database</span> <span class="n">demo</span> <span class="nl">localhost:</span><span class="mi">2435</span> <span class="n">local</span>
</pre></div>

<h4>Start the replication</h4>

<p>Syntax:
</p><div class="highlight"><pre>  &gt; replication start <span class="nt">&lt;database-name&gt;</span> <span class="nt">&lt;server-name&gt;</span>:<span class="nt">&lt;server-port&gt;</span>
</pre></div>
Where:

<ul>
<li>
<code>&lt;database-name&gt;</code> is the database name</li>
<li>
<code>&lt;server-name&gt;&gt;</code> remote server name as host or ip address</li>
<li>
<code>&lt;server-port&gt;&gt;</code> remote server port number</li>
</ul><p>Example to start the replication against the database copied in the previous example:
</p><div class="highlight"><pre>  <span class="o">&gt;</span> <span class="n">replication</span> <span class="n">start</span> <span class="n">demo</span> <span class="nl">localhost:</span><span class="mi">2435</span>
</pre></div>

<h4>Stop the replication</h4>

<p>Syntax:
</p><div class="highlight"><pre>  &gt; replication stop <span class="nt">&lt;database-name&gt;</span> <span class="nt">&lt;server-name&gt;</span>:<span class="nt">&lt;server-port&gt;</span>
</pre></div>
Where:

<ul>
<li>
<code>&lt;database-name&gt;</code> is the database name</li>
<li>
<code>&lt;server-name&gt;&gt;</code> remote server name as host or ip address</li>
<li>
<code>&lt;server-port&gt;&gt;</code> remote server port number</li>
</ul><p>Example to stop the replication against the one started in the previous example:
</p><div class="highlight"><pre>  <span class="o">&gt;</span> <span class="n">replication</span> <span class="n">stop</span> <span class="n">demo</span> <span class="nl">localhost:</span><span class="mi">2435</span>
</pre></div>

<h4>Align a database</h4>

<p>Copies only the record changed to the target remote database.
Syntax:
</p><div class="highlight"><pre>  &gt; replication align <span class="nt">&lt;database-name&gt;</span> <span class="nt">&lt;server-name&gt;</span>:<span class="nt">&lt;server-port&gt;</span>
</pre></div>
Where:

<ul>
<li>
<code>&lt;database-name&gt;</code> is the database name</li>
<li>
<code>&lt;server-name&gt;&gt;</code> remote server name as host or ip address</li>
<li>
<code>&lt;server-port&gt;&gt;</code> remote server port number</li>
</ul><p>Example to align the database replicated above:
</p><div class="highlight"><pre>  <span class="o">&gt;</span> <span class="n">replication</span> <span class="n">align</span> <span class="n">demo</span> <span class="nl">localhost:</span><span class="mi">2435</span>
</pre></div>

<h3>Work with the Journal</h3>

<h4>Get the replication journal</h4>

<p>To retrieve the replication journaluse this command.
Syntax:
</p><div class="highlight"><pre>  &gt; replication get journal <span class="nt">&lt;database-name&gt;</span> <span class="nt">&lt;server-name&gt;</span>:<span class="nt">&lt;server-port&gt;</span>
</pre></div>
Where:

<ul>
<li>
<code>&lt;database-name&gt;</code> is the database name</li>
<li>
<code>&lt;server-name&gt;&gt;</code> remote server name as host or ip address</li>
<li>
<code>&lt;server-port&gt;&gt;</code> remote server port number</li>
</ul><p>Example to display the replication journal against the one started in the previous example:
</p><div class="highlight"><pre>  <span class="o">&gt;</span> <span class="n">replication</span> <span class="n">get</span> <span class="n">journal</span> <span class="n">demo</span> <span class="nl">localhost:</span><span class="mi">2435</span>
  
  <span class="n">Replication</span> <span class="n">journal</span> <span class="k">for</span> <span class="n">database</span> <span class="err">'</span><span class="n">demo</span><span class="err">'</span>
  
  <span class="o">+-----------+--------+---------------+-------------------------+</span>
  <span class="o">|</span> <span class="n">SERIAL</span>    <span class="o">|</span> <span class="n">TYPE</span>   <span class="o">|</span> <span class="n">RECORD</span> <span class="n">ID</span>     <span class="o">|</span> <span class="n">WHEN</span>                    <span class="o">|</span>
  <span class="o">+-----------+--------+---------------+-------------------------+</span>
  <span class="o">|</span> <span class="mi">0</span>         <span class="o">|</span> <span class="n">CREATE</span> <span class="o">|</span> <span class="err">#</span><span class="mi">5</span><span class="o">:</span><span class="mi">1470</span>       <span class="o">|</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">09</span> <span class="mi">02</span><span class="o">:</span><span class="mi">46</span><span class="o">:</span><span class="mf">42.645</span> <span class="o">|</span>
  <span class="o">+-----------+--------+---------------+-------------------------+</span>
</pre></div>

<h4>Reset the replication journal</h4>

<p>This command is to reset the replication journal.
Syntax:
</p><div class="highlight"><pre>  &gt; replication reset journal <span class="nt">&lt;database-name&gt;</span> <span class="nt">&lt;server-name&gt;</span>:<span class="nt">&lt;server-port&gt;</span>
</pre></div>
Where:

<ul>
<li>
<code>&lt;database-name&gt;</code> is the database name</li>
<li>
<code>&lt;server-name&gt;&gt;</code> remote server name as host or ip address</li>
<li>
<code>&lt;server-port&gt;&gt;</code> remote server port number</li>
</ul><p>Example to reset the replication against the one started in the previous example:
</p><div class="highlight"><pre>  <span class="o">&gt;</span> <span class="n">replication</span> <span class="n">reset</span> <span class="n">journal</span> <span class="n">demo</span> <span class="nl">localhost:</span><span class="mi">2435</span>
  
  <span class="n">Reset</span> <span class="n">replication</span> <span class="n">journal</span> <span class="k">for</span> <span class="n">database</span> <span class="err">'</span><span class="n">demo</span><span class="err">'</span><span class="o">:</span> <span class="n">removed</span> <span class="mi">342</span> <span class="n">entries</span><span class="o">.</span>
</pre></div>

<h4>Display replication conflicts</h4>

<p>This command displays the replication conflicts against a database. The conflicts are related to the connected server where the command is fired.
Syntax:
</p><div class="highlight"><pre>  &gt; replication get conflicts <span class="nt">&lt;database-name&gt;</span>
</pre></div>
Where:

<ul>
<li>
<code>&lt;database-name&gt;</code> is the database name</li>
</ul><p>Example to retrieve the replication conflicts:
</p><div class="highlight"><pre>  <span class="o">&gt;</span> <span class="n">replication</span> <span class="n">get</span> <span class="n">conflicts</span> <span class="n">demo</span>
  
</pre></div>


  </div>

</div>

<footer>
  <div class="row">
    <div class="six columns">
      <ul class="inline-list">
        <li><a href="/"> Home</a></li>
<li><a href="/about.html"> About</a></li>
<li class="active"><a href="/wiki/Home.html"> Documentation</a></li>
<li><a href="/wiki/Download.html"> Downloads</a></li>
<li><a href="/community.html"> Community</a></li>
      </ul>
    </div>
    <div class="six columns">
      <p class="copyright">
        Copyright &copy; 2011-2012 NuvolaBase Ltd. <br/>
        <span class="small">NuvolaBase is a registered trademark. All Rights Reserved.</span>
      </p>
    </div>
  </div>
</footer>

<script src="../javascripts/app.js" type="text/javascript"></script>

</body>
</html>