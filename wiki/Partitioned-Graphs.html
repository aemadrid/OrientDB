<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en" xmlns="http://www.w3.org/1999/html"><!--<![endif]-->
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width" />
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  <title>Partitioned Graphs |  OrientDB</title>
  <title>Partitioned Graphs</title>
  <link href="../stylesheets/foundation.min.css" media="screen" rel="stylesheet" type="text/css" />
<link href="../stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
  <script src="../javascripts/modernizr.foundation.js" type="text/javascript"></script>
  
</head>
<body class="wiki wiki_Partitioned-Graphs">

<header>
  <div class="row">
    <div class="five columns">
      <h1>
        <a href="/">
          Orient<span class="highl">DB</span>
        </a>
        <span class="subtitle">The Document/Graph NoSQL Database</span>
      </h1>
    </div>
    <div class="seven columns right">
      <ul class="inline-list">
        <li><a href="/"> Home</a></li>
<li><a href="/about.html"> About</a></li>
<li class="active"><a href="/wiki/Home.html"> Documentation</a></li>
<li><a href="/wiki/Download.html"> Downloads</a></li>
<li><a href="/community.html"> Community</a></li>
      </ul>
    </div>
  </div>
</header>


<div class="page-header">
  <div class="row">
    <div class="twelve columns">
      <h2>
        <i class="icon-wiki"></i>
        Partitioned Graphs
        
          <ul class="bcs">
          
            <li><a href="/wiki/Home.html" class="nr1">Home</a></li>
          
          </ul>
        
        
      </h2>
    </div>
  </div>
</div>

<div id="main" class="row wiki">

  <div class="twelve columns content" role="content">

    <h3>Introduction</h3>

<p>This tutorial explains step-by-step how to create partitioned graphs using the <a class="internal present" href="/wiki/Security.html#record_level_security">Record Level Security</a> feature introduced in OrientDB 1.2.0. This feature is so powerful we can totally separate database's records as sand-boxes where each "Restricted" records can't be accessed by non authorized users. This tutorial demonstrates this sand-boxes works well also with the GraphDB API and the <a class="internal present" href="/wiki/Graph-Database-Tinkerpop.html">TinkerPop stack</a>. Partitioning graphs allows to build real <a href="http://en.wikipedia.org/wiki/Multitenancy">Multi-tenant</a> applications in a breeze.</p>

<p>Requirements:</p>

<ul>
<li>OrientDB 1.2.0-SNAPSHOT or major</li>
<li>!TinkerPop Blueprints 2.2.0 or major.</li>
</ul><p><strong>Index of contents</strong>
</p>

<h3>Create a new empty graph database</h3>

<p>First open the console of the GraphDB Edition and create the new database "blog" of type "graph" against the local file-system:
</p><div class="highlight"><pre>  <span class="n">$</span> <span class="n">cd</span> <span class="n">$ORIENTDB_HOME</span><span class="o">/</span><span class="n">bin</span>
  <span class="n">$</span> <span class="n">console</span><span class="o">.</span><span class="na">sh</span>
  <span class="n">OrientDB</span> <span class="n">console</span> <span class="n">v</span><span class="o">.</span><span class="mf">1.2</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">SNAPSHOT</span> <span class="n">www</span><span class="o">.</span><span class="na">orientechnologies</span><span class="o">.</span><span class="na">com</span>
  <span class="n">Type</span> <span class="err">'</span><span class="n">help</span><span class="err">'</span> <span class="n">to</span> <span class="n">display</span> <span class="n">all</span> <span class="n">the</span> <span class="n">commands</span> <span class="n">supported</span><span class="o">.</span>
  
  <span class="n">Installing</span> <span class="n">extensions</span> <span class="k">for</span> <span class="n">GREMLIN</span> <span class="n">language</span> <span class="n">v</span><span class="o">.</span><span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">SNAPSHOT</span>
  
  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">create</span> <span class="n">database</span> <span class="nl">local:</span><span class="o">../</span><span class="n">databases</span><span class="o">/</span><span class="n">blog</span> <span class="n">admin</span> <span class="n">admin</span> <span class="n">local</span> <span class="n">graph</span>
  <span class="n">Creating</span> <span class="n">database</span> <span class="o">[</span><span class="nl">local:</span><span class="o">../</span><span class="n">databases</span><span class="o">/</span><span class="n">blog</span><span class="o">]</span> <span class="n">using</span> <span class="n">the</span> <span class="n">storage</span> <span class="n">type</span> <span class="o">[</span><span class="n">local</span><span class="o">]...</span>
  <span class="n">Database</span> <span class="n">created</span> <span class="n">successfully</span><span class="o">.</span>
  
  <span class="n">Current</span> <span class="n">database</span> <span class="nl">is:</span> <span class="nl">local:</span><span class="o">../</span><span class="n">databases</span><span class="o">/</span><span class="n">blog</span>
</pre></div>

<h3>Enable graph partitioning</h3>

<p>Now turn on partitioning against graph by letting classes V (Vertex) and E (Edge) to extend the Ã©ORestricted* class. In this way any access to Vertex and Edge instances can be restricted:</p>

<div class="highlight"><pre>  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">alter</span> <span class="kd">class</span> <span class="nc">V</span> <span class="n">superclass</span> <span class="n">orestricted</span>
  
  <span class="n">Class</span> <span class="n">updated</span> <span class="n">successfully</span>
  
  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">alter</span> <span class="kd">class</span> <span class="nc">E</span> <span class="n">superclass</span> <span class="n">orestricted</span>
  
  <span class="n">Class</span> <span class="n">updated</span> <span class="n">successfully</span>
</pre></div>

<h3>Create 2 users</h3>

<p>Now let's go creating 2 users: "luca" and "steve". First ask the current roles in database to know the "writer" role's rid:
</p><div class="highlight"><pre>  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">select</span> <span class="n">from</span> <span class="n">orole</span>
  
  <span class="o">---+---------+--------------------+--------------------+--------------------+--------------------</span>
    <span class="err">#</span><span class="o">|</span> <span class="n">RID</span>     <span class="o">|</span><span class="n">name</span>                <span class="o">|</span><span class="n">mode</span>                <span class="o">|</span><span class="n">rules</span>               <span class="o">|</span><span class="n">inheritedRole</span>
  <span class="o">---+---------+--------------------+--------------------+--------------------+--------------------</span>
    <span class="mi">0</span><span class="o">|</span>     <span class="err">#</span><span class="mi">4</span><span class="o">:</span><span class="mi">0</span><span class="o">|</span><span class="n">admin</span>               <span class="o">|</span><span class="mi">1</span>                   <span class="o">|{}</span>                  <span class="o">|</span><span class="kc">null</span>
    <span class="mi">1</span><span class="o">|</span>     <span class="err">#</span><span class="mi">4</span><span class="o">:</span><span class="mi">1</span><span class="o">|</span><span class="n">reader</span>              <span class="o">|</span><span class="mi">0</span>                   <span class="o">|{</span><span class="n">database</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">schema</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">cluster</span><span class="o">.</span><span class="na">internal</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">cluster</span><span class="o">.</span><span class="na">orole</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">cluster</span><span class="o">.</span><span class="na">ouser</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">class</span><span class="o">.*=</span><span class="mi">2</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">cluster</span><span class="o">.*=</span><span class="mi">2</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">command</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">hook</span><span class="o">.</span><span class="na">record</span><span class="o">=</span><span class="mi">2</span><span class="o">}|</span><span class="kc">null</span>
    <span class="mi">2</span><span class="o">|</span>     <span class="err">#</span><span class="mi">4</span><span class="o">:</span><span class="mi">2</span><span class="o">|</span><span class="n">writer</span>              <span class="o">|</span><span class="mi">0</span>                   <span class="o">|{</span><span class="n">database</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">schema</span><span class="o">=</span><span class="mi">7</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">cluster</span><span class="o">.</span><span class="na">internal</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">cluster</span><span class="o">.</span><span class="na">orole</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">cluster</span><span class="o">.</span><span class="na">ouser</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">class</span><span class="o">.*=</span><span class="mi">15</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">cluster</span><span class="o">.*=</span><span class="mi">15</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">command</span><span class="o">=</span><span class="mi">15</span><span class="o">,</span> <span class="n">database</span><span class="o">.</span><span class="na">hook</span><span class="o">.</span><span class="na">record</span><span class="o">=</span><span class="mi">15</span><span class="o">}|</span><span class="kc">null</span>
  <span class="o">---+---------+--------------------+--------------------+--------------------+--------------------</span>

  <span class="mi">3</span> <span class="n">item</span><span class="o">(</span><span class="n">s</span><span class="o">)</span> <span class="n">found</span><span class="o">.</span> <span class="n">Query</span> <span class="n">executed</span> <span class="n">in</span> <span class="mf">0.045</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
</pre></div>
Found it, it's the #4:2. Not create 2 users with as first role #4:2 (writer):
<div class="highlight"><pre>  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">insert</span> <span class="n">into</span> <span class="n">ouser</span> <span class="n">set</span> <span class="n">name</span> <span class="o">=</span> <span class="err">'</span><span class="n">luca</span><span class="err">'</span><span class="o">,</span> <span class="n">status</span> <span class="o">=</span> <span class="err">'</span><span class="n">ACTIVE</span><span class="err">'</span><span class="o">,</span> <span class="n">password</span> <span class="o">=</span> <span class="err">'</span><span class="n">luca</span><span class="err">'</span><span class="o">,</span> <span class="n">roles</span> <span class="o">=</span> <span class="o">[</span><span class="err">#</span><span class="mi">4</span><span class="o">:</span><span class="mi">2</span><span class="o">]</span>
  
  <span class="n">Inserted</span> <span class="n">record</span> <span class="err">'</span><span class="n">OUser</span><span class="err">#</span><span class="mi">5</span><span class="o">:</span><span class="mi">4</span><span class="o">{</span><span class="nl">name:</span><span class="n">luca</span><span class="o">,</span><span class="nl">password:</span><span class="o">{</span><span class="n">SHA</span><span class="o">-</span><span class="mi">256</span><span class="o">}</span><span class="n">D70F47790F689414789EEFF231703429C7F88A10210775906460EDBF38589D90</span><span class="o">,</span><span class="nl">roles:</span><span class="o">[</span><span class="mi">1</span><span class="o">]}</span> <span class="n">v1</span><span class="err">'</span> <span class="n">in</span> <span class="mi">0</span><span class="o">,</span><span class="mi">001000</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
  
  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">insert</span> <span class="n">into</span> <span class="n">ouser</span> <span class="n">set</span> <span class="n">name</span> <span class="o">=</span> <span class="err">'</span><span class="n">steve</span><span class="err">'</span><span class="o">,</span> <span class="n">status</span> <span class="o">=</span> <span class="err">'</span><span class="n">ACTIVE</span><span class="err">'</span><span class="o">,</span> <span class="n">password</span> <span class="o">=</span> <span class="err">'</span><span class="n">steve</span><span class="err">'</span><span class="o">,</span> <span class="n">roles</span> <span class="o">=</span> <span class="o">[</span><span class="err">#</span><span class="mi">4</span><span class="o">:</span><span class="mi">2</span><span class="o">]</span>
  
  <span class="n">Inserted</span> <span class="n">record</span> <span class="err">'</span><span class="n">OUser</span><span class="err">#</span><span class="mi">5</span><span class="o">:</span><span class="mi">3</span><span class="o">{</span><span class="nl">name:</span><span class="n">steve</span><span class="o">,</span><span class="nl">password:</span><span class="o">{</span><span class="n">SHA</span><span class="o">-</span><span class="mi">256</span><span class="o">}</span><span class="n">F148389D080CFE85952998A8A367E2F7EAF35F2D72D2599A5B0412FE4094D65C</span><span class="o">,</span><span class="nl">roles:</span><span class="o">[</span><span class="mi">1</span><span class="o">]}</span> <span class="n">v1</span><span class="err">'</span> <span class="n">in</span> <span class="mi">0</span><span class="o">,</span><span class="mi">001000</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
  
</pre></div>

<h3>Create a simple graph as user 'Luca'</h3>

<p>Now it's time to disconnect and reconnect to the blog database using the new "luca" user:
</p><div class="highlight"><pre>  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">disconnect</span>
  
  <span class="n">Disconnecting</span> <span class="n">from</span> <span class="n">the</span> <span class="n">database</span> <span class="o">[</span><span class="n">blog</span><span class="o">]...</span><span class="na">OK</span>
  
  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">connect</span> <span class="nl">local:</span><span class="o">../</span><span class="n">databases</span><span class="o">/</span><span class="n">blog</span> <span class="n">luca</span> <span class="n">luca</span>
  <span class="n">Connecting</span> <span class="n">to</span> <span class="n">database</span> <span class="o">[</span><span class="nl">local:</span><span class="o">../</span><span class="n">databases</span><span class="o">/</span><span class="n">blog</span><span class="o">]</span> <span class="n">with</span> <span class="n">user</span> <span class="err">'</span><span class="n">luca</span><span class="err">'</span><span class="o">...</span><span class="na">OK</span>
</pre></div>
Now create 2 vertices: a Restaurant and a Pizza:
<div class="highlight"><pre>  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">create</span> <span class="n">vertex</span> <span class="n">set</span> <span class="n">label</span> <span class="o">=</span> <span class="err">'</span><span class="n">food</span><span class="err">'</span><span class="o">,</span> <span class="n">name</span> <span class="o">=</span> <span class="err">'</span><span class="n">Pizza</span><span class="err">'</span>
  
  <span class="n">Created</span> <span class="n">vertex</span> <span class="err">'</span><span class="n">V</span><span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">0</span><span class="o">{</span><span class="nl">label:</span><span class="n">food</span><span class="o">,</span><span class="nl">name:</span><span class="n">Pizza</span><span class="o">,</span><span class="nl">_allow:</span><span class="o">[</span><span class="mi">1</span><span class="o">]}</span> <span class="n">v0</span><span class="err">'</span> <span class="n">in</span> <span class="mi">0</span><span class="o">,</span><span class="mi">001000</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
  
  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">create</span> <span class="n">vertex</span> <span class="n">set</span> <span class="n">label</span> <span class="o">=</span> <span class="err">'</span><span class="n">restaurant</span><span class="err">'</span><span class="o">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"Dante's Pizza"</span>
  
  <span class="n">Created</span> <span class="n">vertex</span> <span class="err">'</span><span class="n">V</span><span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">1</span><span class="o">{</span><span class="nl">label:</span><span class="n">restaurant</span><span class="o">,</span><span class="nl">name:</span><span class="n">Dante</span><span class="err">'</span><span class="n">s</span> <span class="n">Pizza</span><span class="o">,</span><span class="nl">_allow:</span><span class="o">[</span><span class="mi">1</span><span class="o">]}</span> <span class="n">v0</span><span class="err">'</span> <span class="n">in</span> <span class="mi">0</span><span class="o">,</span><span class="mi">000000</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
</pre></div>
Now connect these 2 vertices with an edge labelled "menu":
<div class="highlight"><pre>  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">create</span> <span class="n">edge</span> <span class="n">from</span> <span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">0</span> <span class="n">to</span> <span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">1</span> <span class="n">set</span> <span class="n">label</span> <span class="o">=</span> <span class="err">'</span><span class="n">menu</span><span class="err">'</span>
  
  <span class="n">Created</span> <span class="n">edge</span> <span class="err">'</span><span class="o">[</span><span class="n">E</span><span class="err">#</span><span class="mi">10</span><span class="o">:</span><span class="mi">0</span><span class="o">{</span><span class="nl">out:</span><span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">0</span><span class="o">,</span><span class="nl">in:</span><span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">1</span><span class="o">,</span><span class="nl">label:</span><span class="n">menu</span><span class="o">,</span><span class="nl">_allow:</span><span class="o">[</span><span class="mi">1</span><span class="o">]}</span> <span class="n">v1</span><span class="o">]</span><span class="err">'</span> <span class="n">in</span> <span class="mi">0</span><span class="o">,</span><span class="mi">003000</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
</pre></div>
To check if everything is ok execute a select against vertices:
<div class="highlight"><pre>  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">select</span> <span class="n">from</span> <span class="n">v</span>
  
  <span class="o">---+---------+--------------------+--------------------+--------------------+--------------------</span>
    <span class="err">#</span><span class="o">|</span> <span class="n">RID</span>     <span class="o">|</span><span class="n">label</span>               <span class="o">|</span><span class="n">name</span>                <span class="o">|</span><span class="n">_allow</span>              <span class="o">|</span><span class="n">out</span>
  <span class="o">---+---------+--------------------+--------------------+--------------------+--------------------</span>
    <span class="mi">0</span><span class="o">|</span>     <span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">0</span><span class="o">|</span><span class="n">food</span>                <span class="o">|</span><span class="n">Pizza</span>               <span class="o">|[</span><span class="mi">1</span><span class="o">]</span>                 <span class="o">|[</span><span class="mi">1</span><span class="o">]</span>
    <span class="mi">1</span><span class="o">|</span>     <span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">1</span><span class="o">|</span><span class="n">restaurant</span>          <span class="o">|</span><span class="n">Dante</span><span class="err">'</span><span class="n">s</span> <span class="n">Pizza</span>       <span class="o">|[</span><span class="mi">1</span><span class="o">]</span>                 <span class="o">|</span><span class="kc">null</span>                <span class="o">|[</span><span class="mi">1</span><span class="o">]</span>
  <span class="o">---+---------+--------------------+--------------------+--------------------+--------------------+--------------------</span>

  <span class="mi">2</span> <span class="n">item</span><span class="o">(</span><span class="n">s</span><span class="o">)</span> <span class="n">found</span><span class="o">.</span> <span class="n">Query</span> <span class="n">executed</span> <span class="n">in</span> <span class="mf">0.034</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
</pre></div>

<h3>Create a simple graph as user 'Steve'</h3>

<p>Now let's connect to the database using the 'Steve' user and check if there are vertices:
</p><div class="highlight"><pre>  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">disconnect</span>
  
  <span class="n">Disconnecting</span> <span class="n">from</span> <span class="n">the</span> <span class="n">database</span> <span class="o">[</span><span class="n">blog</span><span class="o">]...</span><span class="na">OK</span>
  
  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">connect</span> <span class="nl">local:</span><span class="o">../</span><span class="n">databases</span><span class="o">/</span><span class="n">blog</span> <span class="n">steve</span> <span class="n">steve</span>
  <span class="n">Connecting</span> <span class="n">to</span> <span class="n">database</span> <span class="o">[</span><span class="nl">local:</span><span class="o">../</span><span class="n">databases</span><span class="o">/</span><span class="n">blog</span><span class="o">]</span> <span class="n">with</span> <span class="n">user</span> <span class="err">'</span><span class="n">steve</span><span class="err">'</span><span class="o">...</span><span class="na">OK</span>
  
  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">select</span> <span class="n">from</span> <span class="n">v</span>
  
  <span class="mi">0</span> <span class="n">item</span><span class="o">(</span><span class="n">s</span><span class="o">)</span> <span class="n">found</span><span class="o">.</span> <span class="n">Query</span> <span class="n">executed</span> <span class="n">in</span> <span class="mf">0.0</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
</pre></div>
Ok, no vertices found. Try to create something:
<div class="highlight"><pre>  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">create</span> <span class="n">vertex</span> <span class="n">set</span> <span class="n">label</span> <span class="o">=</span> <span class="err">'</span><span class="n">car</span><span class="err">'</span><span class="o">,</span> <span class="n">name</span> <span class="o">=</span> <span class="err">'</span><span class="n">Ferrari</span> <span class="n">Modena</span><span class="err">'</span>
  
  <span class="n">Created</span> <span class="n">vertex</span> <span class="err">'</span><span class="n">V</span><span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">2</span><span class="o">{</span><span class="nl">label:</span><span class="n">car</span><span class="o">,</span><span class="nl">name:</span><span class="n">Ferrari</span> <span class="n">Modena</span><span class="o">,</span><span class="nl">_allow:</span><span class="o">[</span><span class="mi">1</span><span class="o">]}</span> <span class="n">v0</span><span class="err">'</span> <span class="n">in</span> <span class="mi">0</span><span class="o">,</span><span class="mi">000000</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
  
  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">create</span> <span class="n">vertex</span> <span class="n">set</span> <span class="n">label</span> <span class="o">=</span> <span class="err">'</span><span class="n">driver</span><span class="err">'</span><span class="o">,</span> <span class="n">name</span> <span class="o">=</span> <span class="err">'</span><span class="n">steve</span><span class="err">'</span>
  
  <span class="n">Created</span> <span class="n">vertex</span> <span class="err">'</span><span class="n">V</span><span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">3</span><span class="o">{</span><span class="nl">label:</span><span class="n">driver</span><span class="o">,</span><span class="nl">name:</span><span class="n">steve</span><span class="o">,</span><span class="nl">_allow:</span><span class="o">[</span><span class="mi">1</span><span class="o">]}</span> <span class="n">v0</span><span class="err">'</span> <span class="n">in</span> <span class="mi">0</span><span class="o">,</span><span class="mi">000000</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
  
  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">create</span> <span class="n">edge</span> <span class="n">from</span> <span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">2</span> <span class="n">to</span> <span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">3</span> <span class="n">set</span> <span class="n">label</span> <span class="o">=</span> <span class="err">'</span><span class="n">drive</span><span class="err">'</span>
  
  <span class="n">Created</span> <span class="n">edge</span> <span class="err">'</span><span class="o">[</span><span class="n">E</span><span class="err">#</span><span class="mi">10</span><span class="o">:</span><span class="mi">1</span><span class="o">{</span><span class="nl">out:</span><span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">2</span><span class="o">,</span><span class="nl">in:</span><span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">3</span><span class="o">,</span><span class="nl">label:</span><span class="n">drive</span><span class="o">,</span><span class="nl">_allow:</span><span class="o">[</span><span class="mi">1</span><span class="o">]}</span> <span class="n">v1</span><span class="o">]</span><span class="err">'</span> <span class="n">in</span> <span class="mi">0</span><span class="o">,</span><span class="mi">002000</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
</pre></div>
Now check the graph just created:
<div class="highlight"><pre>  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">select</span> <span class="n">from</span> <span class="n">v</span>
  
  <span class="o">---+---------+--------------------+--------------------+--------------------+--------------------</span>
    <span class="err">#</span><span class="o">|</span> <span class="n">RID</span>     <span class="o">|</span><span class="n">label</span>               <span class="o">|</span><span class="n">name</span>                <span class="o">|</span><span class="n">_allow</span>              <span class="o">|</span><span class="n">out</span>
  <span class="o">---+---------+--------------------+--------------------+--------------------+--------------------</span>
    <span class="mi">0</span><span class="o">|</span>     <span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">2</span><span class="o">|</span><span class="n">car</span>                 <span class="o">|</span><span class="n">Ferrari</span> <span class="n">Modena</span>      <span class="o">|[</span><span class="mi">1</span><span class="o">]</span>                 <span class="o">|[</span><span class="mi">1</span><span class="o">]</span>
    <span class="mi">1</span><span class="o">|</span>     <span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">3</span><span class="o">|</span><span class="n">driver</span>              <span class="o">|</span><span class="n">steve</span>               <span class="o">|[</span><span class="mi">1</span><span class="o">]</span>                 <span class="o">|</span><span class="kc">null</span>                <span class="o">|[</span><span class="mi">1</span><span class="o">]</span>
  <span class="o">---+---------+--------------------+--------------------+--------------------+--------------------+--------------------</span>

  <span class="mi">2</span> <span class="n">item</span><span class="o">(</span><span class="n">s</span><span class="o">)</span> <span class="n">found</span><span class="o">.</span> <span class="n">Query</span> <span class="n">executed</span> <span class="n">in</span> <span class="mf">0.034</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
</pre></div>

<p>The "Steve" user doesn't see the vertices and edges creates by other users!</p>

<p>What happen if we try to connect 2 vertices of different users?
</p><div class="highlight"><pre>  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">create</span> <span class="n">edge</span> <span class="n">from</span> <span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">2</span> <span class="n">to</span> <span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">0</span> <span class="n">set</span> <span class="n">label</span> <span class="o">=</span> <span class="err">'</span><span class="n">security</span><span class="o">-</span><span class="n">test</span><span class="err">'</span>
  
  <span class="nl">Error:</span> <span class="n">com</span><span class="o">.</span><span class="na">orientechnologies</span><span class="o">.</span><span class="na">orient</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">exception</span><span class="o">.</span><span class="na">OCommandExecutionException</span><span class="o">:</span> <span class="n">Error</span> <span class="n">on</span> <span class="n">execution</span> <span class="n">of</span> <span class="nl">command:</span> <span class="n">OCommandSQL</span> <span class="o">[</span><span class="n">text</span><span class="o">=</span><span class="n">create</span> <span class="n">edge</span> <span class="n">from</span> <span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">2</span> <span class="n">to</span> <span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">0</span> <span class="n">set</span> <span class="n">label</span> <span class="o">=</span> <span class="err">'</span><span class="n">security</span><span class="o">-</span><span class="n">test</span><span class="err">'</span><span class="o">]</span>
  <span class="nl">Error:</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">IllegalArgumentException</span><span class="o">:</span> <span class="n">Source</span> <span class="n">vertex</span> <span class="err">'#</span><span class="mi">9</span><span class="o">:</span><span class="mi">0</span><span class="err">'</span> <span class="n">does</span> <span class="n">not</span> <span class="n">exist</span>
</pre></div>

<p>The partition is totally isolated and OrientDB thinks the vertex doesn't exist while it's present, but invisible to the current user.</p>

<h3>!TinkerPop Stack</h3>

<p><a class="internal present" href="/wiki/Security.html#record_level_security">Record Level Security</a> feature is very powerful because acts at low level inside the OrientDB engine. This is why everything works like a charm, even the <a class="internal present" href="/wiki/Graph-Database-Tinkerpop.html">TinkerPop stack</a>.</p>

<p>Now try to display all the vertices and edges using <a class="internal present" href="/wiki/Gremlin.html">Gremlin</a>:
</p><div class="highlight"><pre>  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">gremlin</span> <span class="n">g</span><span class="o">.</span><span class="na">V</span>
  
  <span class="o">[</span><span class="n">v</span><span class="o">[</span><span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">2</span><span class="o">],</span> <span class="n">v</span><span class="o">[</span><span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">3</span><span class="o">]]</span>
  
  <span class="n">Script</span> <span class="n">executed</span> <span class="n">in</span> <span class="mi">0</span><span class="o">,</span><span class="mi">448000</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
  <span class="n">orientdb</span><span class="o">&gt;</span> <span class="n">gremlin</span> <span class="n">g</span><span class="o">.</span><span class="na">E</span>
  
  <span class="n">e</span><span class="o">[</span><span class="err">#</span><span class="mi">10</span><span class="o">:</span><span class="mi">1</span><span class="o">][</span><span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">2</span><span class="o">-</span><span class="n">drive</span><span class="o">-&gt;</span><span class="err">#</span><span class="mi">9</span><span class="o">:</span><span class="mi">3</span><span class="o">]</span>
  
  <span class="n">Script</span> <span class="n">executed</span> <span class="n">in</span> <span class="mi">0</span><span class="o">,</span><span class="mi">123000</span> <span class="n">sec</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
</pre></div>

<p>The same is using other technologies that use the !TinkerPop Blueprints: <a href="https://github.com/tinkerpop/rexster/wiki">TinkerPop Rexter</a>, <a href="https://github.com/tinkerpop/pipes/wiki">TinkerPop Pipes</a>, <a href="https://github.com/tinkerpop/furnace/wiki">TinkerPop Furnace</a>, <a href="https://github.com/tinkerpop/frames/wiki">TinkerPop Frames</a> and <a href="http://thinkaurelius.github.com/faunus/">ThinkAurelius Faunus</a>.</p>


  </div>

</div>

<footer>
  <div class="row">
    <div class="six columns">
      <ul class="inline-list">
        <li><a href="/"> Home</a></li>
<li><a href="/about.html"> About</a></li>
<li class="active"><a href="/wiki/Home.html"> Documentation</a></li>
<li><a href="/wiki/Download.html"> Downloads</a></li>
<li><a href="/community.html"> Community</a></li>
      </ul>
    </div>
    <div class="six columns">
      <p class="copyright">
        Copyright &copy; 2011-2012 NuvolaBase Ltd. <br/>
        <span class="small">NuvolaBase is a registered trademark. All Rights Reserved.</span>
      </p>
    </div>
  </div>
</footer>

<script src="../javascripts/app.js" type="text/javascript"></script>

</body>
</html>